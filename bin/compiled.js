'use strict';var g=void 0,h=!0,k=null,l=!1,m=this;function n(a,b){var c=a.split("."),d=m;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&b!==g?d[f]=b:d=d[f]?d[f]:d[f]={}}function q(a){a.m=function(){return a.r?a.r:a.r=new a}}function s(a,b){function c(){}c.prototype=b.prototype;a.R=b.prototype;a.prototype=new c};function t(a){window.console.error("Nucleus log: "+a)};function u(){this.data=k;this.height=this.width=0;this.h=l;this.K=k}u.prototype.f=function(){return this.height};u.prototype.g=function(){return this.width};function v(){u.call(this);this.data=new Image}s(v,u);function w(){}w.prototype.create=function(a){var b=k;try{var c={premultipliedAlpha:l,alpha:l},b=a.getContext("webgl",c)||a.getContext("experimental-webgl",c)}catch(d){}b===k&&alert("Missing context");return b};function x(){this.z=new w;this.p=[];this.l=k}q(x);function y(){return x.m().l}x.prototype.create=function(a){a=this.z.create(a);this.t(a);this.l==k&&(this.l=a);return a};x.prototype.t=function(a){this.p[this.p.length]=a};function z(a){a=a||y();this.id=a.createTexture();this.source=k}z.prototype.bind=function(){y().bindTexture(3553,this.id)};z.prototype.create=function(a,b){var c=y(),d;d=new v;d=this.source=d;d.width=a;d.height=b;this.bind();d=y();d.texParameteri(3553,10241,9985);d.texParameteri(3553,10240,9729);this.source.g()==this.source.f()&&y().generateMipmap(3553);c.texImage2D(3553,0,6408,a,b,0,6408,5121,k);y().bindTexture(3553,k)};
z.prototype.fill=function(a){var b=y();this.bind();b.texImage2D(3553,0,6408,6408,5121,a)};z.prototype.f=function(){return this.source.f()};z.prototype.g=function(){return this.source.g()};function A(a){this.id=y().createShader(a);this.h=l}A.prototype.fill=function(a){var b=y();b.shaderSource(this.id,a);b.compileShader(this.id);this.h=h};function B(a){if(5124!=a){if(5126==a)return"float";if(35664==a)return"vec2";if(35665==a)return"vec3";if(35666==a)return"vec4";if(3==a)return"sampler2D";if(1==a)return"mat3";if(0==a)return"mat4";if(35670==a)return"bool"}return"int"};function C(){this.id=-1;this.count=1;this.data=0;this.elements=new D;this.B=5126;this.normalize=l;this.offset=0;this.precision="lowp";this.type=5124};function D(){this.elements=[];this.A=0}D.prototype.add=function(a,b,c,d,f){var e=new C;e.type=c;e.count=b;e.precision=d||"lowp";e.B=f||5126;this.elements[a]=e;this.A++};function E(){this.c=new D;this.e=new A(35632);this.id=y().createProgram();this.b=new D;this.i=new A(35633);this.j=0}E.prototype.bind=function(){y().useProgram(this.id)};function F(a){this.q="";this.L=[];this.a=a||new E;this.d=[];this.V=this.v=this.u=h;this.w=""}function G(a){var b=H("Main"),b=b+"void main() \n{ \n ",b=b+(a+"\n");return b+="} \n "}function H(a){var b;b="\n////////////////////////////////// \n";b+="/// "+(a.charAt(0).toUpperCase()+a.slice(1))+".\n";return b+="////////////////////////////////// \n"}function I(a,b,c){var d=B(b.type),f="",f=c==g||c==h?a:"v"+a.substring(1);return b.precision+" "+d+" "+f+";"}
function J(a,b){var c=b==l?"attribute":"varying",d=H(c+"s"),f=a.a.c.elements,e;for(e in f)d+=c+" "+I(e,f[e],!b)+"\n";return d}
F.prototype.create=function(){this.a==k&&t("ProgramBuilder can't generate the given program.");var a="",b="";if(this.v){var c=new D;c.add("ambient",1,35665);c.add("diffuse",1,35666);c.add("specular",1,35665);c.add("shininess",1,5126);this.d.Material=c}this.u&&(c=new D,c.add("position",1,35665),c.add("direction",1,35665),c.add("color",1,35665),this.d.Light=c);this.a==k&&t("Program is null, ProgramBuilder can't add default uniforms.");this.a.b.add("uMvp",1,0,"mediump");this.a.b.add("uModel",1,0,"mediump");
this.a.b.add("uAmbientLight",1,35665,g);this.v&&this.a.b.add("uMaterial",1,12,g);this.u&&this.a.b.add("uLight",14,12,g);this.a.c.add("aPosition",3,35665,g);this.a.c.add("aColor",4,35666,g);this.a.c.add("aTexCoord",2,35664,g);this.a.c.add("aNormal",3,35665,g);var d,c="";for(d in this.d){var c=c+H(d+" structure"),c=c+("struct "+d+"\n"),c=c+"{\n",f;for(f in this.d[d].elements)c+="\t"+I(f,this.d[d].elements[f])+"\n";c+="};\n"}d=c;var a=a+d,b=b+d,e;d=H("Uniforms");f=k;var c="",j=this.a.b.elements;for(e in j)c=
1<j[e].count?"["+j[e].count+"]":"",f=12==j[e].type?e.substr(1):j[e].precision+" "+B(j[e].type),d+="uniform "+f+" "+e+c+"; \n";e=d;b+=e;a=a+e+J(this,l);a+=J(this,h);b+=J(this,h);b+=G(this.q);a+=G(this.w);e=this.a;e.e.fill(b);e.i.fill(a);if(!(e.e.h==l||e.i.h==l))if(b=y(),b.attachShader(e.id,e.i.id),b.attachShader(e.id,e.e.id),b.linkProgram(e.id),y().deleteShader(e.i.id),y().deleteShader(e.e.id),b.getProgramParameter(e.id,35714)){var b=y(),a=e.c.elements,p;for(p in a)d=a[p],d.id=b.getAttribLocation(e.id,
p),-1!=d.id&&(f=5126==d.type?4:3,d.offset=e.j,e.j+=d.count*f);p=y();var b=e.b.elements,r;for(r in b)b[r].id=p.getUniformLocation(e.id,r),b[r].id==k&&(b[r].id=-1)}else t("Error found during shader compilation.");return this.a};function K(){this.n=[]}q(K);K.prototype.t=function(a,b){this.n[a]=b};function L(a){this.C=a}L.prototype.create=function(){return new z(this.C)};function M(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}M.prototype.BYTES_PER_ELEMENT=8;M.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};M.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{M.BYTES_PER_ELEMENT=8}catch(aa){}M.prototype.BYTES_PER_ELEMENT=M.prototype.BYTES_PER_ELEMENT;M.prototype.set=M.prototype.set;M.prototype.toString=M.prototype.toString;n("Float64Array",M)};function N(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}N.prototype.BYTES_PER_ELEMENT=4;N.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};N.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(N.BYTES_PER_ELEMENT=4,N.prototype.BYTES_PER_ELEMENT=N.prototype.BYTES_PER_ELEMENT,N.prototype.set=N.prototype.set,N.prototype.toString=N.prototype.toString,n("Float32Array",N));function O(a,b){var c=new Float32Array(3);c[0]=a;c[1]=1;c[2]=b;return c}function P(a,b){var c=a[0],d=a[1],f=a[2],c=1/Math.sqrt(c*c+d*d+f*f);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c}function Q(a,b,c){var d=a[0],f=a[1];a=a[2];var e=b[0],j=b[1];b=b[2];c[0]=f*b-a*j;c[1]=a*e-d*b;c[2]=d*j-f*e};function R(a,b,c,d,f,e,j,p,r){a[0]=b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=d;a[11]=f;a[12]=e;a[13]=j;a[14]=p;a[15]=r;return a}function S(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}new Float64Array(3);new Float64Array(3);var T=[new Float64Array(4),new Float64Array(4),new Float64Array(4)];new Float64Array(16);function U(){var a=new Float32Array(16);a[0]=a[5]=a[10]=a[15]=1;this.O=a;this.position=new Float32Array(3);this.rotation=new Float32Array(3);this.scale=O(1,1);this.P=h};function V(a){U.call(this);this.F=new Float32Array(16);this.s=new Float32Array(16);this.Q=new Float32Array(9);this.D=O(0,0);var b=new Float32Array(16),c=this.position,d=this.D,f=T[0],e=[0,0,-5];f[0]=e[0]-c[0];f[1]=e[1]-c[1];f[2]=e[2]-c[2];P(f,f);f[3]=0;e=T[1];Q(f,d,e);P(e,e);e[3]=0;d=T[2];Q(e,f,d);P(d,d);d[3]=0;f[0]=-f[0];f[1]=-f[1];f[2]=-f[2];S(b,0,e);S(b,1,d);S(b,2,f);b[3]=0;b[7]=0;b[11]=0;b[15]=1;var f=-c[0],d=-c[1],c=-c[2],e=b[1]*f+b[5]*d+b[9]*c+b[13],j=b[2]*f+b[6]*d+b[10]*c+b[14],p=b[3]*f+b[7]*
d+b[11]*c+b[15];b[12]=b[0]*f+b[4]*d+b[8]*c+b[12];b[13]=e;b[14]=j;b[15]=p;this.F=b;switch(a){case "2D":a=new Float32Array(16);this.s=R(a,1,1,-2/99,0,-0,-0,-101/99,1);break;default:a=800/600,b=new Float32Array(16),c=Math.sin(22.5),0==c||0==a?a=b:(c=Math.cos(22.5)/c,a=R(b,c/a,c,-101/99,-1,0,0,-200/99,0)),this.s=a}}s(V,U);function W(a){this.parent=k;this.children=[];this.o=0;this.U=a||new U}W.prototype.add=function(a){this.children[this.o]=a;this.o++};function X(){W.call(this);this.color=O(1,1);this.direction=O(1,1);this.H=O(0,0);this.I=h}s(X,W);function Y(){X.call(this)}s(Y,X);function Z(){W.call(this);this.G=new Y;this.M=[];this.N=0}s(Z,W);function ba(){this.S=this.a=k};function $(a){this.k=x.m().create(a);this.T=new L(this.k);this.J=new ba}$.prototype.f=function(){return 0};$.prototype.g=function(){return 0};window.application=function(){var a=new $(document.getElementById("test"));new V("3D");new Z;var b=K.m();if(b.n["default"]==g){var c;c="vColor\t\t  = aColor; \ngl_Position   = (uMvp * uModel) * vec4( aPosition, 1.0);";var d=new F;d.w=c;d.q="gl_FragColor  = vColor;";b.n["default"]=d.create()}a.k.clearColor(0.2,0.2,0.2,1);a.k.clear(16640)};
